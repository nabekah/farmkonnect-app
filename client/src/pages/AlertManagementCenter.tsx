import React, { useState, useEffect } from 'react';\nimport { AlertCircle, CheckCircle, Clock, X, Filter, Search, Bell, Trash2 } from 'lucide-react';\n\ninterface Alert {\n  id: string;\n  type: 'budget' | 'forecast' | 'supplier' | 'weather' | 'task';\n  severity: 'low' | 'medium' | 'high' | 'critical';\n  title: string;\n  message: string;\n  timestamp: number;\n  read: boolean;\n  acknowledged: boolean;\n  snoozedUntil?: number;\n}\n\ninterface AlertFilter {\n  type: 'all' | 'unread' | 'acknowledged' | 'snoozed';\n  severity: 'all' | 'low' | 'medium' | 'high' | 'critical';\n  category: 'all' | 'budget' | 'forecast' | 'supplier' | 'weather' | 'task';\n}\n\nconst AlertManagementCenter: React.FC = () => {\n  const [alerts, setAlerts] = useState<Alert[]>([]);\n  const [filter, setFilter] = useState<AlertFilter>({\n    type: 'all',\n    severity: 'all',\n    category: 'all',\n  });\n  const [searchQuery, setSearchQuery] = useState('');\n  const [selectedAlerts, setSelectedAlerts] = useState<Set<string>>(new Set());\n  const [showFilters, setShowFilters] = useState(false);\n\n  // Mock data\n  useEffect(() => {\n    const mockAlerts: Alert[] = [\n      {\n        id: 'alert-1',\n        type: 'budget',\n        severity: 'high',\n        title: 'Budget Threshold Exceeded',\n        message: 'Fertilizer spending has reached 85% of monthly budget',\n        timestamp: Date.now() - 3600000,\n        read: false,\n        acknowledged: false,\n      },\n      {\n        id: 'alert-2',\n        type: 'forecast',\n        severity: 'medium',\n        title: 'Revenue Forecast Updated',\n        message: 'Q2 revenue forecast shows 12% increase from previous quarter',\n        timestamp: Date.now() - 7200000,\n        read: true,\n        acknowledged: true,\n      },\n      {\n        id: 'alert-3',\n        type: 'supplier',\n        severity: 'critical',\n        title: 'Supplier Performance Alert',\n        message: 'Seed supplier delivery performance degraded to 78%',\n        timestamp: Date.now() - 10800000,\n        read: false,\n        acknowledged: false,\n      },\n      {\n        id: 'alert-4',\n        type: 'weather',\n        severity: 'high',\n        title: 'Severe Weather Warning',\n        message: 'Heavy rain expected in 24 hours - may impact field operations',\n        timestamp: Date.now() - 14400000,\n        read: true,\n        acknowledged: false,\n      },\n      {\n        id: 'alert-5',\n        type: 'task',\n        severity: 'low',\n        title: 'Task Reminder',\n        message: 'Soil testing scheduled for tomorrow at 10:00 AM',\n        timestamp: Date.now() - 86400000,\n        read: true,\n        acknowledged: true,\n      },\n    ];\n    setAlerts(mockAlerts);\n  }, []);\n\n  const filteredAlerts = alerts.filter((alert) => {\n    let matches = true;\n\n    if (filter.type === 'unread') matches = matches && !alert.read;\n    if (filter.type === 'acknowledged') matches = matches && alert.acknowledged;\n    if (filter.type === 'snoozed') matches = matches && alert.snoozedUntil && alert.snoozedUntil > Date.now();\n\n    if (filter.severity !== 'all') matches = matches && alert.severity === filter.severity;\n    if (filter.category !== 'all') matches = matches && alert.type === filter.category;\n\n    if (searchQuery) {\n      const query = searchQuery.toLowerCase();\n      matches = matches && (alert.title.toLowerCase().includes(query) || alert.message.toLowerCase().includes(query));\n    }\n\n    return matches;\n  });\n\n  const unreadCount = alerts.filter((a) => !a.read).length;\n  const criticalCount = alerts.filter((a) => a.severity === 'critical' && !a.acknowledged).length;\n\n  const handleMarkAsRead = (id: string) => {\n    setAlerts(alerts.map((a) => (a.id === id ? { ...a, read: true } : a)));\n  };\n\n  const handleAcknowledge = (id: string) => {\n    setAlerts(alerts.map((a) => (a.id === id ? { ...a, acknowledged: true } : a)));\n  };\n\n  const handleSnooze = (id: string, minutes: number) => {\n    setAlerts(\n      alerts.map((a) =>\n        a.id === id ? { ...a, snoozedUntil: Date.now() + minutes * 60000 } : a\n      )\n    );\n  };\n\n  const handleDelete = (id: string) => {\n    setAlerts(alerts.filter((a) => a.id !== id));\n    setSelectedAlerts((prev) => {\n      const next = new Set(prev);\n      next.delete(id);\n      return next;\n    });\n  };\n\n  const handleSelectAlert = (id: string) => {\n    setSelectedAlerts((prev) => {\n      const next = new Set(prev);\n      if (next.has(id)) {\n        next.delete(id);\n      } else {\n        next.add(id);\n      }\n      return next;\n    });\n  };\n\n  const handleBulkAcknowledge = () => {\n    setAlerts(\n      alerts.map((a) =>\n        selectedAlerts.has(a.id) ? { ...a, acknowledged: true } : a\n      )\n    );\n    setSelectedAlerts(new Set());\n  };\n\n  const handleBulkDelete = () => {\n    setAlerts(alerts.filter((a) => !selectedAlerts.has(a.id)));\n    setSelectedAlerts(new Set());\n  };\n\n  const getSeverityColor = (severity: Alert['severity']) => {\n    switch (severity) {\n      case 'critical':\n        return 'bg-red-100 text-red-800 border-red-300';\n      case 'high':\n        return 'bg-orange-100 text-orange-800 border-orange-300';\n      case 'medium':\n        return 'bg-yellow-100 text-yellow-800 border-yellow-300';\n      case 'low':\n        return 'bg-blue-100 text-blue-800 border-blue-300';\n    }\n  };\n\n  const getTypeIcon = (type: Alert['type']) => {\n    const iconProps = { size: 16 };\n    switch (type) {\n      case 'budget':\n        return 'ðŸ’°';\n      case 'forecast':\n        return 'ðŸ“ˆ';\n      case 'supplier':\n        return 'ðŸ­';\n      case 'weather':\n        return 'â›…';\n      case 'task':\n        return 'âœ“';\n    }\n  };\n\n  const formatTime = (timestamp: number) => {\n    const now = Date.now();\n    const diff = now - timestamp;\n    const hours = Math.floor(diff / 3600000);\n    const days = Math.floor(hours / 24);\n\n    if (hours < 1) return 'Just now';\n    if (hours < 24) return `${hours}h ago`;\n    if (days < 7) return `${days}d ago`;\n    return new Date(timestamp).toLocaleDateString();\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 p-6\">\n      <div className=\"max-w-6xl mx-auto\">\n        {/* Header */}\n        <div className=\"mb-8\">\n          <div className=\"flex justify-between items-start mb-4\">\n            <div>\n              <h1 className=\"text-3xl font-bold text-gray-900\">Alert Management Center</h1>\n              <p className=\"text-gray-600 mt-2\">Manage and track all farm alerts and notifications</p>\n            </div>\n            <div className=\"flex gap-2\">\n              {criticalCount > 0 && (\n                <div className=\"bg-red-100 text-red-800 px-4 py-2 rounded-lg font-semibold\">\n                  {criticalCount} Critical\n                </div>\n              )}\n              {unreadCount > 0 && (\n                <div className=\"bg-blue-100 text-blue-800 px-4 py-2 rounded-lg font-semibold\">\n                  {unreadCount} Unread\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n\n        {/* Search and Filters */}\n        <div className=\"bg-white rounded-lg p-4 shadow-sm border border-gray-200 mb-6\">\n          <div className=\"flex gap-4 mb-4\">\n            <div className=\"flex-1 relative\">\n              <Search className=\"absolute left-3 top-3 text-gray-400\" size={20} />\n              <input\n                type=\"text\"\n                placeholder=\"Search alerts...\"\n                value={searchQuery}\n                onChange={(e) => setSearchQuery(e.target.value)}\n                className=\"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              />\n            </div>\n            <button\n              onClick={() => setShowFilters(!showFilters)}\n              className=\"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-2\"\n            >\n              <Filter size={18} />\n              Filters\n            </button>\n          </div>\n\n          {showFilters && (\n            <div className=\"grid grid-cols-3 gap-4 pt-4 border-t border-gray-200\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">Status</label>\n                <select\n                  value={filter.type}\n                  onChange={(e) => setFilter({ ...filter, type: e.target.value as any })}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                >\n                  <option value=\"all\">All Alerts</option>\n                  <option value=\"unread\">Unread</option>\n                  <option value=\"acknowledged\">Acknowledged</option>\n                  <option value=\"snoozed\">Snoozed</option>\n                </select>\n              </div>\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">Severity</label>\n                <select\n                  value={filter.severity}\n                  onChange={(e) => setFilter({ ...filter, severity: e.target.value as any })}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                >\n                  <option value=\"all\">All Levels</option>\n                  <option value=\"critical\">Critical</option>\n                  <option value=\"high\">High</option>\n                  <option value=\"medium\">Medium</option>\n                  <option value=\"low\">Low</option>\n                </select>\n              </div>\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">Category</label>\n                <select\n                  value={filter.category}\n                  onChange={(e) => setFilter({ ...filter, category: e.target.value as any })}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                >\n                  <option value=\"all\">All Categories</option>\n                  <option value=\"budget\">Budget</option>\n                  <option value=\"forecast\">Forecast</option>\n                  <option value=\"supplier\">Supplier</option>\n                  <option value=\"weather\">Weather</option>\n                  <option value=\"task\">Task</option>\n                </select>\n              </div>\n            </div>\n          )}\n        </div>\n\n        {/* Bulk Actions */}\n        {selectedAlerts.size > 0 && (\n          <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6 flex justify-between items-center\">\n            <p className=\"text-blue-900 font-medium\">{selectedAlerts.size} alert(s) selected</p>\n            <div className=\"flex gap-2\">\n              <button\n                onClick={handleBulkAcknowledge}\n                className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium\"\n              >\n                Acknowledge All\n              </button>\n              <button\n                onClick={handleBulkDelete}\n                className=\"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 font-medium\"\n              >\n                Delete All\n              </button>\n            </div>\n          </div>\n        )}\n\n        {/* Alerts List */}\n        <div className=\"space-y-3\">\n          {filteredAlerts.length === 0 ? (\n            <div className=\"bg-white rounded-lg p-12 text-center border border-gray-200\">\n              <Bell className=\"mx-auto text-gray-400 mb-4\" size={48} />\n              <p className=\"text-gray-600 font-medium\">No alerts match your filters</p>\n            </div>\n          ) : (\n            filteredAlerts.map((alert) => (\n              <div\n                key={alert.id}\n                className={`bg-white rounded-lg p-4 border-l-4 transition-all ${\n                  getSeverityColor(alert.severity)\n                } ${!alert.read ? 'shadow-md' : 'shadow-sm'}`}\n              >\n                <div className=\"flex gap-4\">\n                  <input\n                    type=\"checkbox\"\n                    checked={selectedAlerts.has(alert.id)}\n                    onChange={() => handleSelectAlert(alert.id)}\n                    className=\"mt-1 w-5 h-5 rounded border-gray-300 cursor-pointer\"\n                  />\n                  <div className=\"flex-1\">\n                    <div className=\"flex items-start justify-between\">\n                      <div className=\"flex items-start gap-3 flex-1\">\n                        <span className=\"text-xl mt-1\">{getTypeIcon(alert.type)}</span>\n                        <div className=\"flex-1\">\n                          <h3 className=\"font-semibold text-gray-900\">{alert.title}</h3>\n                          <p className=\"text-gray-700 mt-1\">{alert.message}</p>\n                          <p className=\"text-sm text-gray-500 mt-2\">{formatTime(alert.timestamp)}</p>\n                        </div>\n                      </div>\n                      <div className=\"flex gap-2\">\n                        {!alert.read && (\n                          <button\n                            onClick={() => handleMarkAsRead(alert.id)}\n                            className=\"p-2 hover:bg-gray-200 rounded-lg transition-colors\"\n                            title=\"Mark as read\"\n                          >\n                            <CheckCircle size={18} />\n                          </button>\n                        )}\n                        {!alert.acknowledged && (\n                          <button\n                            onClick={() => handleAcknowledge(alert.id)}\n                            className=\"p-2 hover:bg-gray-200 rounded-lg transition-colors\"\n                            title=\"Acknowledge\"\n                          >\n                            <Clock size={18} />\n                          </button>\n                        )}\n                        <button\n                          onClick={() => handleDelete(alert.id)}\n                          className=\"p-2 hover:bg-gray-200 rounded-lg transition-colors\"\n                          title=\"Delete\"\n                        >\n                          <Trash2 size={18} />\n                        </button>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            ))\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default AlertManagementCenter;\n
