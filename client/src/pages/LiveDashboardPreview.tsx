import React, { useState, useEffect, useCallback } from 'react';\nimport { RefreshCw, Pause, Play, Settings, Download } from 'lucide-react';\n\nexport interface DashboardMetric {\n  id: string;\n  title: string;\n  value: number | string;\n  unit?: string;\n  trend?: 'up' | 'down' | 'stable';\n  trendPercent?: number;\n  format?: 'number' | 'currency' | 'percentage';\n  lastUpdated?: number;\n}\n\nexport interface DashboardChart {\n  id: string;\n  title: string;\n  type: 'line' | 'bar' | 'pie' | 'area';\n  data: any[];\n  lastUpdated?: number;\n}\n\nexport interface LiveDashboardState {\n  metrics: DashboardMetric[];\n  charts: DashboardChart[];\n  lastRefresh: number;\n  isLive: boolean;\n  refreshInterval: number;\n}\n\nconst LiveDashboardPreview: React.FC = () => {\n  const [dashboard, setDashboard] = useState<LiveDashboardState>({\n    metrics: [\n      {\n        id: 'metric-1',\n        title: 'Total Revenue',\n        value: 45230,\n        unit: 'USD',\n        trend: 'up',\n        trendPercent: 12.5,\n        format: 'currency',\n        lastUpdated: Date.now(),\n      },\n      {\n        id: 'metric-2',\n        title: 'Active Crops',\n        value: 24,\n        trend: 'stable',\n        format: 'number',\n        lastUpdated: Date.now(),\n      },\n      {\n        id: 'metric-3',\n        title: 'Soil Health',\n        value: 85,\n        unit: '%',\n        trend: 'up',\n        trendPercent: 5.2,\n        format: 'percentage',\n        lastUpdated: Date.now(),\n      },\n      {\n        id: 'metric-4',\n        title: 'Equipment Status',\n        value: 18,\n        unit: 'operational',\n        trend: 'down',\n        trendPercent: 2.1,\n        format: 'number',\n        lastUpdated: Date.now(),\n      },\n    ],\n    charts: [\n      {\n        id: 'chart-1',\n        title: 'Daily Revenue Trend',\n        type: 'line',\n        data: generateChartData('line', 30),\n        lastUpdated: Date.now(),\n      },\n      {\n        id: 'chart-2',\n        title: 'Crop Distribution',\n        type: 'pie',\n        data: generateChartData('pie', 5),\n        lastUpdated: Date.now(),\n      },\n      {\n        id: 'chart-3',\n        title: 'Monthly Expenses',\n        type: 'bar',\n        data: generateChartData('bar', 12),\n        lastUpdated: Date.now(),\n      },\n      {\n        id: 'chart-4',\n        title: 'Yield Forecast',\n        type: 'area',\n        data: generateChartData('area', 12),\n        lastUpdated: Date.now(),\n      },\n    ],\n    lastRefresh: Date.now(),\n    isLive: true,\n    refreshInterval: 5000,\n  });\n\n  const [isPaused, setIsPaused] = useState(false);\n  const [autoRefresh, setAutoRefresh] = useState(true);\n  const [selectedMetric, setSelectedMetric] = useState<string | null>(null);\n\n  // Simulate real-time updates\n  useEffect(() => {\n    if (!autoRefresh || isPaused) return;\n\n    const interval = setInterval(() => {\n      setDashboard((prev) => ({\n        ...prev,\n        metrics: prev.metrics.map((metric) => ({\n          ...metric,\n          value:\n            typeof metric.value === 'number'\n              ? metric.value + (Math.random() - 0.5) * 100\n              : metric.value,\n          lastUpdated: Date.now(),\n        })),\n        charts: prev.charts.map((chart) => ({\n          ...chart,\n          data: generateChartData(chart.type, chart.data.length),\n          lastUpdated: Date.now(),\n        })),\n        lastRefresh: Date.now(),\n      }));\n    }, dashboard.refreshInterval);\n\n    return () => clearInterval(interval);\n  }, [autoRefresh, isPaused, dashboard.refreshInterval]);\n\n  const formatValue = (metric: DashboardMetric): string => {\n    if (typeof metric.value === 'string') return metric.value;\n\n    switch (metric.format) {\n      case 'currency':\n        return `$${metric.value.toLocaleString('en-US', { maximumFractionDigits: 0 })}`;\n      case 'percentage':\n        return `${metric.value.toFixed(1)}%`;\n      case 'number':\n      default:\n        return metric.value.toLocaleString('en-US', { maximumFractionDigits: 0 });\n    }\n  };\n\n  const handleRefresh = useCallback(() => {\n    setDashboard((prev) => ({\n      ...prev,\n      metrics: prev.metrics.map((m) => ({\n        ...m,\n        lastUpdated: Date.now(),\n      })),\n      charts: prev.charts.map((c) => ({\n        ...c,\n        lastUpdated: Date.now(),\n      })),\n      lastRefresh: Date.now(),\n    }));\n  }, []);\n\n  const handleDownload = () => {\n    const data = JSON.stringify(dashboard, null, 2);\n    const blob = new Blob([data], { type: 'application/json' });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = `dashboard-${Date.now()}.json`;\n    a.click();\n  };\n\n  const getTimeSinceUpdate = (timestamp?: number): string => {\n    if (!timestamp) return 'Never';\n    const seconds = Math.floor((Date.now() - timestamp) / 1000);\n    if (seconds < 60) return `${seconds}s ago`;\n    if (seconds < 3600) return `${Math.floor(seconds / 60)}m ago`;\n    return `${Math.floor(seconds / 3600)}h ago`;\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 p-6\">\n      {/* Header */}\n      <div className=\"max-w-7xl mx-auto mb-8\">\n        <div className=\"flex items-center justify-between mb-6\">\n          <div>\n            <h1 className=\"text-4xl font-bold text-gray-900\">Live Dashboard Preview</h1>\n            <p className=\"text-gray-600 mt-2\">\n              Last updated: {new Date(dashboard.lastRefresh).toLocaleTimeString()}\n            </p>\n          </div>\n          <div className=\"flex gap-3\">\n            <button\n              onClick={() => setAutoRefresh(!autoRefresh)}\n              className={`flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-colors ${\n                autoRefresh\n                  ? 'bg-green-600 text-white hover:bg-green-700'\n                  : 'bg-gray-200 text-gray-900 hover:bg-gray-300'\n              }`}\n            >\n              {autoRefresh ? (\n                <>\n                  <Play size={18} />\n                  Live\n                </>\n              ) : (\n                <>\n                  <Pause size={18} />\n                  Paused\n                </>\n              )}\n            </button>\n            <button\n              onClick={handleRefresh}\n              className=\"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium\"\n            >\n              <RefreshCw size={18} />\n              Refresh\n            </button>\n            <button\n              onClick={handleDownload}\n              className=\"flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors font-medium\"\n            >\n              <Download size={18} />\n              Export\n            </button>\n          </div>\n        </div>\n\n        {/* Controls */}\n        <div className=\"flex gap-4 items-center bg-white p-4 rounded-lg shadow-sm border border-gray-200\">\n          <label className=\"flex items-center gap-2 text-sm font-medium text-gray-700\">\n            Refresh Interval:\n            <select\n              value={dashboard.refreshInterval}\n              onChange={(e) =>\n                setDashboard((prev) => ({\n                  ...prev,\n                  refreshInterval: parseInt(e.target.value),\n                }))\n              }\n              className=\"px-3 py-1 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            >\n              <option value={1000}>1 second</option>\n              <option value={5000}>5 seconds</option>\n              <option value={10000}>10 seconds</option>\n              <option value={30000}>30 seconds</option>\n              <option value={60000}>1 minute</option>\n            </select>\n          </label>\n          <div className=\"ml-auto text-sm text-gray-600\">\n            {dashboard.isLive ? (\n              <span className=\"flex items-center gap-2\">\n                <span className=\"w-2 h-2 bg-green-500 rounded-full animate-pulse\"></span>\n                Live Updates Active\n              </span>\n            ) : (\n              <span>Manual Updates Only</span>\n            )}\n          </div>\n        </div>\n      </div>\n\n      {/* Metrics Grid */}\n      <div className=\"max-w-7xl mx-auto mb-8\">\n        <h2 className=\"text-2xl font-bold text-gray-900 mb-4\">Key Metrics</h2>\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n          {dashboard.metrics.map((metric) => (\n            <div\n              key={metric.id}\n              onClick={() => setSelectedMetric(metric.id)}\n              className={`bg-white rounded-lg shadow-sm border-2 p-6 cursor-pointer transition-all ${\n                selectedMetric === metric.id\n                  ? 'border-blue-500 ring-2 ring-blue-200'\n                  : 'border-gray-200 hover:border-gray-300'\n              }`}\n            >\n              <div className=\"flex items-start justify-between mb-3\">\n                <h3 className=\"text-sm font-medium text-gray-600\">{metric.title}</h3>\n                <span className=\"text-xs text-gray-500\">{getTimeSinceUpdate(metric.lastUpdated)}</span>\n              </div>\n              <div className=\"mb-3\">\n                <p className=\"text-3xl font-bold text-gray-900\">{formatValue(metric)}</p>\n                {metric.unit && <p className=\"text-sm text-gray-500 mt-1\">{metric.unit}</p>}\n              </div>\n              {metric.trend && (\n                <div\n                  className={`flex items-center gap-1 text-sm font-medium ${\n                    metric.trend === 'up'\n                      ? 'text-green-600'\n                      : metric.trend === 'down'\n                        ? 'text-red-600'\n                        : 'text-gray-600'\n                  }`}\n                >\n                  {metric.trend === 'up' && '↑'}\n                  {metric.trend === 'down' && '↓'}\n                  {metric.trend === 'stable' && '→'}\n                  {metric.trendPercent && `${metric.trendPercent}%`}\n                </div>\n              )}\n            </div>\n          ))}\n        </div>\n      </div>\n\n      {/* Charts Grid */}\n      <div className=\"max-w-7xl mx-auto\">\n        <h2 className=\"text-2xl font-bold text-gray-900 mb-4\">Analytics</h2>\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n          {dashboard.charts.map((chart) => (\n            <div\n              key={chart.id}\n              className=\"bg-white rounded-lg shadow-sm border border-gray-200 p-6\"\n            >\n              <div className=\"flex items-start justify-between mb-4\">\n                <div>\n                  <h3 className=\"text-lg font-semibold text-gray-900\">{chart.title}</h3>\n                  <p className=\"text-xs text-gray-500 mt-1\">\n                    Updated: {getTimeSinceUpdate(chart.lastUpdated)}\n                  </p>\n                </div>\n                <span className=\"px-2 py-1 bg-gray-100 text-gray-700 text-xs font-medium rounded\">\n                  {chart.type}\n                </span>\n              </div>\n              <div className=\"bg-gray-50 rounded-lg p-8 text-center text-gray-500 min-h-64 flex items-center justify-center\">\n                <div>\n                  <p className=\"font-medium mb-2\">Chart: {chart.title}</p>\n                  <p className=\"text-sm\">Type: {chart.type}</p>\n                  <p className=\"text-sm\">Data points: {chart.data.length}</p>\n                </div>\n              </div>\n            </div>\n          ))}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nfunction generateChartData(type: string, count: number): any[] {\n  const data = [];\n  for (let i = 0; i < count; i++) {\n    data.push({\n      label: `Point ${i + 1}`,\n      value: Math.random() * 100,\n      timestamp: Date.now() - (count - i) * 1000,\n    });\n  }\n  return data;\n}\n\nexport default LiveDashboardPreview;\n
