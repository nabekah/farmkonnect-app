import React, { useState, useMemo } from 'react';\nimport { BarChart3, TrendingUp, TrendingDown, AlertCircle, Download, RefreshCw } from 'lucide-react';\n\nexport interface MetricData {\n  id: string;\n  name: string;\n  value: number;\n  unit: string;\n  change: number;\n  trend: 'up' | 'down' | 'stable';\n  timestamp: number;\n}\n\nexport interface ChartDataPoint {\n  timestamp: number;\n  value: number;\n}\n\nexport interface DashboardMetrics {\n  metrics: MetricData[];\n  timeSeries: Record<string, ChartDataPoint[]>;\n  trends: Array<{ metric: string; direction: 'up' | 'down' | 'stable'; percentChange: number }>;\n  statistics: {\n    totalMetrics: number;\n    activeMetrics: number;\n    averageLatency: number;\n    p95Latency: number;\n  };\n}\n\ninterface AnalyticsDashboardUIProps {\n  data: DashboardMetrics;\n  onRefresh: () => void;\n  onExport: (format: 'csv' | 'json') => void;\n  isLoading?: boolean;\n}\n\nconst AnalyticsDashboardUI: React.FC<AnalyticsDashboardUIProps> = ({\n  data,\n  onRefresh,\n  onExport,\n  isLoading = false,\n}) => {\n  const [selectedMetric, setSelectedMetric] = useState<string | null>(null);\n  const [timeRange, setTimeRange] = useState<'hour' | 'day' | 'week' | 'month'>('day');\n\n  const topMetrics = useMemo(() => {\n    return data.metrics.slice(0, 4);\n  }, [data.metrics]);\n\n  const getTrendIcon = (trend: 'up' | 'down' | 'stable') => {\n    switch (trend) {\n      case 'up':\n        return <TrendingUp size={20} className=\"text-green-600\" />;\n      case 'down':\n        return <TrendingDown size={20} className=\"text-red-600\" />;\n      default:\n        return <BarChart3 size={20} className=\"text-slate-600\" />;\n    }\n  };\n\n  const getTrendColor = (trend: 'up' | 'down' | 'stable') => {\n    switch (trend) {\n      case 'up':\n        return 'text-green-600 bg-green-50';\n      case 'down':\n        return 'text-red-600 bg-red-50';\n      default:\n        return 'text-slate-600 bg-slate-50';\n    }\n  };\n\n  const formatValue = (value: number, unit: string): string => {\n    if (unit === '%') {\n      return `${value.toFixed(1)}%`;\n    }\n    if (unit === 'ms') {\n      return `${value.toFixed(0)}ms`;\n    }\n    if (value >= 1000000) {\n      return `${(value / 1000000).toFixed(1)}M ${unit}`;\n    }\n    if (value >= 1000) {\n      return `${(value / 1000).toFixed(1)}K ${unit}`;\n    }\n    return `${value.toFixed(1)} ${unit}`;\n  };\n\n  return (\n    <div className=\"w-full bg-white rounded-lg border border-slate-200 p-6\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between mb-6\">\n        <div>\n          <h1 className=\"text-2xl font-bold\">Analytics Dashboard</h1>\n          <p className=\"text-slate-600 text-sm mt-1\">Real-time system metrics and performance analytics</p>\n        </div>\n        <div className=\"flex gap-2\">\n          <button\n            onClick={onRefresh}\n            disabled={isLoading}\n            className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-slate-400 flex items-center gap-2\"\n          >\n            <RefreshCw size={18} className={isLoading ? 'animate-spin' : ''} />\n            Refresh\n          </button>\n          <button\n            onClick={() => onExport('csv')}\n            className=\"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 flex items-center gap-2\"\n          >\n            <Download size={18} />\n            Export\n          </button>\n        </div>\n      </div>\n\n      {/* Time Range Selector */}\n      <div className=\"mb-6 flex gap-2\">\n        {(['hour', 'day', 'week', 'month'] as const).map((range) => (\n          <button\n            key={range}\n            onClick={() => setTimeRange(range)}\n            className={`px-4 py-2 rounded-lg font-semibold transition-colors ${\n              timeRange === range\n                ? 'bg-blue-600 text-white'\n                : 'bg-slate-100 text-slate-700 hover:bg-slate-200'\n            }`}\n          >\n            {range.charAt(0).toUpperCase() + range.slice(1)}\n          </button>\n        ))}\n      </div>\n\n      {/* Key Metrics Cards */}\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6\">\n        {topMetrics.map((metric) => (\n          <div key={metric.id} className=\"p-4 bg-gradient-to-br from-slate-50 to-slate-100 rounded-lg border border-slate-200\">\n            <div className=\"flex items-start justify-between mb-3\">\n              <div>\n                <p className=\"text-sm text-slate-600 font-semibold\">{metric.name}</p>\n                <p className=\"text-2xl font-bold mt-1\">{formatValue(metric.value, metric.unit)}</p>\n              </div>\n              {getTrendIcon(metric.trend)}\n            </div>\n            <div className={`inline-flex items-center gap-1 px-2 py-1 rounded text-sm font-semibold ${getTrendColor(metric.trend)}`}>\n              {metric.trend === 'up' ? '+' : metric.trend === 'down' ? '-' : ''}\n              {Math.abs(metric.change).toFixed(1)}%\n            </div>\n          </div>\n        ))}\n      </div>\n\n      {/* Statistics Section */}\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6\">\n        <div className=\"p-4 bg-blue-50 rounded-lg border border-blue-200\">\n          <h3 className=\"font-semibold text-blue-900 mb-3\">System Performance</h3>\n          <div className=\"space-y-2 text-sm\">\n            <div className=\"flex justify-between\">\n              <span className=\"text-blue-700\">Total Metrics:</span>\n              <span className=\"font-semibold text-blue-900\">{data.statistics.totalMetrics}</span>\n            </div>\n            <div className=\"flex justify-between\">\n              <span className=\"text-blue-700\">Active Metrics:</span>\n              <span className=\"font-semibold text-blue-900\">{data.statistics.activeMetrics}</span>\n            </div>\n            <div className=\"flex justify-between\">\n              <span className=\"text-blue-700\">Avg Latency:</span>\n              <span className=\"font-semibold text-blue-900\">{data.statistics.averageLatency.toFixed(0)}ms</span>\n            </div>\n            <div className=\"flex justify-between\">\n              <span className=\"text-blue-700\">P95 Latency:</span>\n              <span className=\"font-semibold text-blue-900\">{data.statistics.p95Latency.toFixed(0)}ms</span>\n            </div>\n          </div>\n        </div>\n\n        <div className=\"p-4 bg-purple-50 rounded-lg border border-purple-200\">\n          <h3 className=\"font-semibold text-purple-900 mb-3\">Trend Analysis</h3>\n          <div className=\"space-y-2 text-sm\">\n            {data.trends.slice(0, 4).map((trend, idx) => (\n              <div key={idx} className=\"flex justify-between items-center\">\n                <span className=\"text-purple-700 truncate\">{trend.metric}</span>\n                <div className=\"flex items-center gap-1\">\n                  {getTrendIcon(trend.direction)}\n                  <span className=\"font-semibold text-purple-900\">{trend.percentChange.toFixed(1)}%</span>\n                </div>\n              </div>\n            ))}\n          </div>\n        </div>\n      </div>\n\n      {/* Detailed Metrics Table */}\n      <div className=\"mb-6\">\n        <h2 className=\"text-lg font-bold mb-4\">All Metrics</h2>\n        <div className=\"overflow-x-auto\">\n          <table className=\"w-full text-sm\">\n            <thead>\n              <tr className=\"border-b border-slate-200 bg-slate-50\">\n                <th className=\"px-4 py-3 text-left font-semibold text-slate-700\">Metric Name</th>\n                <th className=\"px-4 py-3 text-right font-semibold text-slate-700\">Value</th>\n                <th className=\"px-4 py-3 text-right font-semibold text-slate-700\">Change</th>\n                <th className=\"px-4 py-3 text-right font-semibold text-slate-700\">Trend</th>\n                <th className=\"px-4 py-3 text-right font-semibold text-slate-700\">Updated</th>\n              </tr>\n            </thead>\n            <tbody>\n              {data.metrics.map((metric) => (\n                <tr\n                  key={metric.id}\n                  className=\"border-b border-slate-200 hover:bg-slate-50 cursor-pointer\"\n                  onClick={() => setSelectedMetric(metric.id)}\n                >\n                  <td className=\"px-4 py-3 font-medium text-slate-900\">{metric.name}</td>\n                  <td className=\"px-4 py-3 text-right text-slate-600\">{formatValue(metric.value, metric.unit)}</td>\n                  <td className={`px-4 py-3 text-right font-semibold ${\n                    metric.change > 0 ? 'text-green-600' : metric.change < 0 ? 'text-red-600' : 'text-slate-600'\n                  }`}>\n                    {metric.change > 0 ? '+' : ''}{metric.change.toFixed(1)}%\n                  </td>\n                  <td className=\"px-4 py-3 text-right\">\n                    <div className=\"flex justify-end\">{getTrendIcon(metric.trend)}</div>\n                  </td>\n                  <td className=\"px-4 py-3 text-right text-slate-500 text-xs\">\n                    {new Date(metric.timestamp).toLocaleTimeString()}\n                  </td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n      </div>\n\n      {/* Alerts Section */}\n      {data.metrics.some((m) => m.trend === 'down' && m.change < -10) && (\n        <div className=\"p-4 bg-yellow-50 rounded-lg border border-yellow-200\">\n          <div className=\"flex items-start gap-3\">\n            <AlertCircle size={20} className=\"text-yellow-600 mt-0.5\" />\n            <div>\n              <h3 className=\"font-semibold text-yellow-900\">Performance Alerts</h3>\n              <p className=\"text-sm text-yellow-800 mt-1\">\n                {data.metrics.filter((m) => m.trend === 'down' && m.change < -10).length} metrics showing significant\n                downward trends. Review and investigate.\n              </p>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default AnalyticsDashboardUI;\n
